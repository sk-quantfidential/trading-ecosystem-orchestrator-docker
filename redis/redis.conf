# Redis Configuration for Trading Ecosystem Infrastructure
# Following Redis 8.x standards for service discovery and caching

# Network and Security
bind 0.0.0.0
port 6379
protected-mode yes
tcp-backlog 2048
tcp-keepalive 60

# Memory and Eviction (4GB limit for development)
maxmemory 4gb
maxmemory-policy allkeys-lfu
maxmemory-samples 10

# Performance Optimizations
activedefrag yes
lazyfree-lazy-eviction yes
lazyfree-lazy-expire yes
lazyfree-lazy-server-del yes
active-expire-effort 5

# I/O Threading (Redis 8.x performance feature)
io-threads 4
io-threads-do-reads yes

# Persistence Strategy (ephemeral cache + session persistence)
save ""
appendonly yes
appendfsync everysec
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb
aof-use-rdb-preamble yes
aof-rewrite-incremental-fsync yes
aof-load-truncated yes

# Security and Authentication
aclfile /usr/local/etc/redis/users.acl

# Client Limits
maxclients 10000
timeout 300

# Observability
slowlog-log-slower-than 10000
slowlog-max-len 128
latency-monitor-threshold 100

# Logging
loglevel notice
logfile ""
syslog-enabled no

# Key Naming Convention for Trading Ecosystem:
# market:* - Market data adapter keys
# exchange:* - Exchange adapter keys
# custodian:* - Custodian adapter keys
# risk:* - Risk adapter keys
# trading:* - Trading adapter keys
# test:* - Test coordination adapter keys
# audit:* - Audit adapter keys
# registry:* - Service registry keys
# config:* - Configuration service keys